W0203 12:09:54.730000 1516397 .venv/lib/python3.12/site-packages/torch/distributed/run.py:803] 
W0203 12:09:54.730000 1516397 .venv/lib/python3.12/site-packages/torch/distributed/run.py:803] *****************************************
W0203 12:09:54.730000 1516397 .venv/lib/python3.12/site-packages/torch/distributed/run.py:803] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0203 12:09:54.730000 1516397 .venv/lib/python3.12/site-packages/torch/distributed/run.py:803] *****************************************
2026-02-03 12:10:03,586 - nanochat.flash_attention - [32m[1mINFO[0m - Flash Attention enabled. Using compiled cuda kernels from flash_attn package.
2026-02-03 12:10:04,771 - nanochat.flash_attention - [32m[1mINFO[0m - Flash Attention enabled. Using compiled cuda kernels from flash_attn package.
2026-02-03 12:10:08,084 - nanochat.common - [32m[1mINFO[0m - Distributed world size: 2
wandb: Tracking run with wandb version 0.24.0
wandb: W&B syncing is set to `offline` in this directory. Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
wandb: Run data is saved locally in /public_hw/share/cit_ztyu/cz/nanochat/wandb/offline-run-20260203_121008-y723ajoj
2026-02-03 12:10:09,427 - nanochat.checkpoint_manager - [32m[1mINFO[0m - Loading model from /public_hw/share/cit_ztyu/cz/nanochat/mid_checkpoints/d26 with step 818
2026-02-03 12:10:12,710 - nanochat.checkpoint_manager - [32m[1mINFO[0m - Patching missing window_pattern in model config to 'L'
2026-02-03 12:10:12,712 - nanochat.checkpoint_manager - [32m[1mINFO[0m - Building model with config: {'sequence_len': 2048, 'vocab_size': 32768, 'n_layer': 26, 'n_head': 13, 'n_kv_head': 13, 'n_embd': 1664, 'window_pattern': 'L'}
2026-02-03 12:18:55,126 - nanochat.checkpoint_manager - [32m[1mINFO[0m - Saved model parameters to: /public_hw/share/cit_ztyu/cz/nanochat/chatsft_checkpoints/d26/model_000700.pt
2026-02-03 12:18:55,133 - nanochat.checkpoint_manager - [32m[1mINFO[0m - Saved metadata to: /public_hw/share/cit_ztyu/cz/nanochat/chatsft_checkpoints/d26/meta_000700.json
wandb: 
wandb: Run history:
wandb: arc_easy_acc â–â–…â–…â–ˆ
wandb:          lrm â–ˆâ–ˆâ–ˆâ–ˆâ–‡â–‡â–‡â–‡â–‡â–†â–†â–†â–†â–†â–…â–…â–…â–…â–„â–„â–„â–„â–„â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–‚â–‚â–‚â–‚â–‚â–â–â–â–â–
wandb:     mmlu_acc â–â–ƒâ–„â–ˆ
wandb:   num_tokens â–†â–…â–‚â–‚â–…â–„â–ƒâ–ˆâ–…â–„â–ƒâ–‡â–„â–†â–‚â–ƒâ–â–„â–…â–‚â–ƒâ–…â–ƒâ–…â–…â–ƒâ–‡â–†â–…â–…â–…â–†â–†â–…â–„â–ˆâ–ƒâ–…â–‚â–ˆ
wandb:         step â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–…â–…â–…â–…â–…â–†â–†â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆâ–ˆ
wandb:   train_loss â–â–‡â–„â–‡â–‚â–ƒâ–„â–ƒâ–…â–†â–„â–‡â–„â–†â–„â–‚â–„â–„â–…â–„â–‚â–†â–„â–†â–†â–ƒâ–†â–…â–ˆâ–ˆâ–„â–…â–ƒâ–„â–†â–…â–…â–„â–…â–…
wandb:     val_loss â–â–‡â–ˆâ–ˆâ–‡â–‡â–‡â–‡
wandb: 
wandb: Run summary:
wandb: arc_easy_acc 0.72807
wandb:          lrm 0.00285
wandb:     mmlu_acc 0.41016
wandb:   num_tokens 13055
wandb:         step 700
wandb:   train_loss 0.38867
wandb:     val_loss 0.80021
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /public_hw/share/cit_ztyu/cz/nanochat/wandb/offline-run-20260203_121008-y723ajoj
wandb: Find logs at: ./wandb/offline-run-20260203_121008-y723ajoj/logs
[W203 12:18:58.107811431 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
