W0203 00:36:42.382000 421272 .venv/lib/python3.12/site-packages/torch/distributed/run.py:803] 
W0203 00:36:42.382000 421272 .venv/lib/python3.12/site-packages/torch/distributed/run.py:803] *****************************************
W0203 00:36:42.382000 421272 .venv/lib/python3.12/site-packages/torch/distributed/run.py:803] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0203 00:36:42.382000 421272 .venv/lib/python3.12/site-packages/torch/distributed/run.py:803] *****************************************
2026-02-03 00:36:47,651 - nanochat.flash_attention - [32m[1mINFO[0m - Flash Attention enabled. Using compiled cuda kernels from flash_attn package.
2026-02-03 00:36:47,656 - nanochat.flash_attention - [32m[1mINFO[0m - Flash Attention enabled. Using compiled cuda kernels from flash_attn package.
2026-02-03 00:36:50,107 - nanochat.common - [32m[1mINFO[0m - Distributed world size: 2
wandb: Tracking run with wandb version 0.24.0
wandb: W&B syncing is set to `offline` in this directory. Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
wandb: Run data is saved locally in /public_hw/share/cit_ztyu/cz/nanochat/wandb/offline-run-20260203_003650-n7p6eumv
2026-02-03 00:36:51,073 - nanochat.checkpoint_manager - [32m[1mINFO[0m - Loading model from /public_hw/share/cit_ztyu/cz/nanochat/base_checkpoints/d26 with step 130500
2026-02-03 00:36:53,600 - nanochat.checkpoint_manager - [32m[1mINFO[0m - Building model with config: {'sequence_len': 2048, 'vocab_size': 32768, 'n_layer': 26, 'n_head': 13, 'n_kv_head': 13, 'n_embd': 1664, 'window_pattern': 'SSSL'}
2026-02-03 01:31:26,010 - nanochat.checkpoint_manager - [32m[1mINFO[0m - Saved model parameters to: /public_hw/share/cit_ztyu/cz/nanochat/mid_checkpoints/d26/model_000818.pt
2026-02-03 01:31:26,015 - nanochat.checkpoint_manager - [32m[1mINFO[0m - Saved metadata to: /public_hw/share/cit_ztyu/cz/nanochat/mid_checkpoints/d26/meta_000818.json
2026-02-03 01:31:29,394 - nanochat.checkpoint_manager - [32m[1mINFO[0m - Saved optimizer state to: /public_hw/share/cit_ztyu/cz/nanochat/mid_checkpoints/d26/optim_000818_rank0.pt
wandb: 
wandb: Run history:
wandb:                 step â–â–â–â–â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–„â–…â–…â–…â–…â–…â–†â–†â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆ
wandb: total_training_flops â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–„â–…â–…â–…â–…â–†â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆ
wandb:  total_training_time â–â–â–â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–„â–„â–„â–„â–„â–„â–„â–…â–…â–…â–…â–…â–…â–…â–…â–…â–†â–†â–†â–†â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆâ–ˆ
wandb:             train/dt â–â–…â–…â–†â–„â–ƒâ–„â–„â–†â–…â–…â–ˆâ–†â–„â–†â–†â–…â–†â–†â–†â–…â–„â–…â–†â–…â–…â–†â–„â–…â–†â–†â–ƒâ–…â–†â–†â–…â–„â–„â–„â–†
wandb:          train/epoch â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
wandb:           train/loss â–ˆâ–†â–…â–†â–…â–„â–„â–„â–„â–ƒâ–ƒâ–„â–„â–„â–ƒâ–ƒâ–ƒâ–„â–„â–„â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–‚â–ƒâ–‚â–‚â–â–‚â–‚â–‚â–â–â–‚â–â–‚â–â–
wandb:            train/lrm â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‡â–†â–†â–…â–„â–ƒâ–ƒâ–‚â–‚â–
wandb:            train/mfu â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
wandb:    train/tok_per_sec â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‡â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
wandb:              val/bpb â–ˆâ–‚â–‚â–‚â–‚â–‚â–‚â–â–â–
wandb: 
wandb: Run summary:
wandb:                 step 818
wandb: total_training_flops 2652683299561930752
wandb:  total_training_time 2880.91531
wandb:             train/dt 3.56318
wandb:          train/epoch 1
wandb:           train/loss 0.93301
wandb:            train/lrm 0.04445
wandb:            train/mfu 46.01167
wandb:    train/tok_per_sec 147140
wandb:              val/bpb 0.32103
wandb: 
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /public_hw/share/cit_ztyu/cz/nanochat/wandb/offline-run-20260203_003650-n7p6eumv
wandb: Find logs at: ./wandb/offline-run-20260203_003650-n7p6eumv/logs
[W203 01:31:34.460405981 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
